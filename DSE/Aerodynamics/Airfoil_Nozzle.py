import numpy as np
import matplotlib.pyplot as plt

naca = np.array([[0.00000  ,   0.00000],
[0.00795  ,   -0.01017],
[0.01082  ,   -0.01214],
[0.01634  ,   -0.01517],
[0.02950  ,   -0.02013],
[0.05508  ,   -0.02664],
[0.08027  ,   -0.03123],
[0.10527  ,   -0.03476],
[0.15496  ,   -0.03972],
[0.20442  ,   -0.04290],
[0.25375  ,   -0.04460],
[0.30300  ,   -0.04499],
[0.35222  ,   -0.04407],
[0.40143  ,   -0.04172],
[0.45068  ,   -0.03814],
[0.50000  ,   -0.03356],
[0.54942  ,   -0.02823],
[0.59895  ,   -0.02239],
[0.64861  ,   -0.01629],
[0.69841  ,   -0.01015],
[0.74837  ,   -0.00430],
[0.79847  ,   0.00083],
[0.84873  ,   0.00483],
[0.89911  ,   0.00704],
[0.94958  ,   0.00651],
[1.00000  ,   0.00000]])

nasasc = np.array([[0.000000,  0.000000],
  [0.002000, -0.007600],
  [0.005000, -0.011600],
  [0.010000, -0.015500],
  [0.020000, -0.020700],
  [0.030000, -0.024300],
  [0.040000, -0.027000],
  [0.050000, -0.029200],
  [0.060000, -0.031100],
  [0.070000, -0.032800],
  [0.080000, -0.034300],
  [0.090000, -0.035700],
  [0.100000, -0.036900],
  [0.110000, -0.038000],
  [0.120000, -0.039000],
  [0.130000, -0.040000],
  [0.140000, -0.040900],
  [0.150000, -0.041700],
  [0.160000, -0.042500],
  [0.170000, -0.043200],
  [0.180000, -0.043900],
  [0.190000, -0.044500],
  [0.200000, -0.045100],
  [0.210000, -0.045600],
  [0.220000, -0.046100],
  [0.230000, -0.046600],
  [0.240000, -0.047000],
  [0.250000, -0.047400],
  [0.260000, -0.047800],
  [0.270000, -0.048100],
  [0.280000, -0.048400],
  [0.290000, -0.048700],
  [0.300000, -0.049000],
  [0.310000, -0.049200],
  [0.320000, -0.049400],
  [0.330000, -0.049600],
  [0.340000, -0.049700],
  [0.350000, -0.049800],
  [0.360000, -0.049900],
  [0.370000, -0.050000],
  [0.380000, -0.050000],
  [0.390000, -0.050000],
  [0.400000, -0.050000],
  [0.410000, -0.050000],
  [0.420000, -0.049900],
  [0.430000, -0.049800],
  [0.440000, -0.049700],
  [0.450000, -0.049600],
  [0.460000, -0.049400],
  [0.470000, -0.049200],
  [0.480000, -0.049000],
  [0.490000, -0.048700],
  [0.500000, -0.048400],
  [0.510000, -0.048100],
  [0.520000, -0.047800],
  [0.530000, -0.047400],
  [0.540000, -0.047000],
  [0.550000, -0.046500],
  [0.560000, -0.046000],
  [0.570000, -0.045500],
  [0.580000, -0.044900],
  [0.590000, -0.044300],
  [0.600000, -0.043600],
  [0.610000, -0.042800],
  [0.620000, -0.042000],
  [0.630000, -0.041100],
  [0.640000, -0.040200],
  [0.650000, -0.039200],
  [0.660000, -0.038200],
  [0.670000, -0.037150],
  [0.680000, -0.036100],
  [0.690000, -0.035050],
  [0.700000, -0.034000],
  [0.710000, -0.032950],
  [0.720000, -0.031900],
  [0.730000, -0.030850],
  [0.740000, -0.029800],
  [0.750000, -0.028750],
  [0.760000, -0.027700],
  [0.770000, -0.026650],
  [0.780000, -0.025600],
  [0.790000, -0.024550],
  [0.800000, -0.023500],
  [0.810000, -0.022450],
  [0.820000, -0.021400],
  [0.830000, -0.020350],
  [0.840000, -0.019300],
  [0.850000, -0.018250],
  [0.860000, -0.017200],
  [0.870000, -0.016150],
  [0.880000, -0.015100],
  [0.890000, -0.014050],
  [0.900000, -0.013000],
  [0.910000, -0.011950],
  [0.920000, -0.010900],
  [0.930000, -0.009850],
  [0.940000, -0.008800],
  [0.950000, -0.007750],
  [0.960000, -0.006700],
  [0.970000, -0.005650],
  [0.980000, -0.004600],
  [0.990000, -0.003550],
  [1.000000, -0.002500]])



mach_area = 0.11965 #from aero textbook, M=0.59

cw = 2.44
cs = 0.45*cw
nasasc = nasasc*cs
naca = naca*cw
nasasc[:,0] = nasasc[:,0]+0.15*cw


nacafunc = np.polyfit(naca[:,0],naca[:,1],12)
x = np.linspace(0,cw,1001)

def reconstruct_f(coeff, plot_nodes):
	F = 0;
	coeff = coeff[::-1];
	for i in range(len(coeff)):
		F += coeff[i]*plot_nodes**i;
	return F;

y = reconstruct_f(nacafunc,x)

#plt.plot(naca[:,0],naca[:,1])
#plt.plot(x,y)
#plt.show()
naca = np.ones((1001,2))
naca[:,0] = x
naca [:,1] = -y

nasafunc = np.polyfit(nasasc[:,0],nasasc[:,1],12)
xs = np.linspace(nasasc[0,0],nasasc[-1,0],451)

def reconstruct_f(coeff, plot_nodes):
	F = 0;
	coeff = coeff[::-1];
	for i in range(len(coeff)):
		F += coeff[i]*plot_nodes**i;
	return F;

ys = reconstruct_f(nasafunc,xs)


#plt.plot(naca[:,0],naca[:,1])
#plt.plot(x,y)
#plt.show()
nasasc = np.ones((451,2))
nasasc[:,0] = xs
nasasc[:,1] = -ys


plt.plot(nasasc[:,0],nasasc[:,1])
plt.plot(naca[:,0],naca[:,1])
plt.show()

area = np.zeros(451)
add = np.where(naca[:,0] == cw*0.15)[0][0]
print(nasasc[0])

for i in range(451):
	area[i] = (naca[(i+add),1] - naca[(add),1])  + nasasc[i,1]


biig = area.max()
print("Max delta A=",biig)
indloc = np.where(area[:] == biig)[0][0]

loc = naca[(add+indloc)]
print("Location x/y of NACA",loc)
print("Location x/y of NASA SC",nasasc[indloc])

throat = biig/mach_area
print("Throat =", throat)
print(naca[add])
#verification
deltaA = loc[1] - naca[add,1]
VMax_A = deltaA + nasasc[indloc,1]
print(VMax_A - biig)